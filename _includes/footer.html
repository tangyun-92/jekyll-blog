    <footer class="container">

      {% include footer-ad.html %}

        <div class="site-footer" role="contentinfo">
            <div class="copyright left mobile-block">
                    © 2021
                    <span title="{{ site.author}}">{{ site.author }}</span>
                    <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a>
            </div>

            <ul class="site-footer-links right mobile-hidden">
                <li>
                    <a href="javascript:window.scrollTo(0,0)" >TOP</a>
                </li>
            </ul>
            <a href="{{ site.github.repository_url }}" target="_blank" aria-label="view source code">
                <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
            </a>
            <ul class="site-footer-links mobile-hidden">
                {% for nav in site.navs %}
                <li>
                    <a href="{{ site.url }}{{ nav.href }}" title="{{ nav.label }}" target="{{ nav.target | default: _self }}">{{ nav.label }}</a>
                </li>
                {% endfor %}
                <li><a href="{{ site.url }}{{ site.subscribe_rss }}"><span class="octicon octicon-rss" style="color:orange;"></span></a></li>
            </ul>

          {% include visit-stat.html %}

        </div>
    </footer>
    <div class="tools-wrapper">
      <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a>
    </div>
    <!-- / footer -->
    {% if site.components.share.enabled %}
    <script src="{{ assets_base_url }}/assets/vendor/share.js/dist/js/share.min.js"></script>
    {% endif %}
    <script src="{{ assets_base_url }}/assets/js/geopattern.js"></script>
    <script>
      jQuery(document).ready(function($) {
        $('.geopattern').each(function(){
          $(this).geopattern($(this).data('pattern-id'));
        });
       /* hljs.initHighlightingOnLoad(); */
      });
    </script>

    {% if page.mermaid %}
    <script src="{{ assets_base_url }}/assets/js/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    {% endif %}

    {% if page.sequence %}
    <script src="{{ assets_base_url }}/assets/js/webfont.js"></script>
    <script src="{{ assets_base_url }}/assets/js/snap.svg-min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/underscore@1.13.1/underscore-umd-min.js"></script>
    <script src="{{ assets_base_url }}/assets/vendor/js-sequence-diagrams/dist/sequence-diagram-min.js"></script>
    <link rel="stylesheet" href="{{ assets_base_url }}/assets/vendor/js-sequence-diagrams/dist/sequence-diagram-min.css">
    <script>
      $(".language-sequence").sequenceDiagram({theme: 'simple'});
    </script>
    {% endif %}

    {% if page.flow %}
    <script src="{{ assets_base_url }}/assets/js/raphael.min.js"></script>
    <script src="{{ assets_base_url }}/assets/vendor/flowchart.js/dist/flowchart.min.js"></script>
    <script src="{{ assets_base_url }}/assets/js/flow.js"></script>
    {% endif %}

    {% if page.mathjax %}
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/mathjax/MathJax@2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    {% endif %}

    {% if page.mindmap %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mzlogin/kityminder-core@dev/dist/kityminder.core.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/mzlogin/kity@dev/dist/kity.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/mzlogin/kityminder-core@dev/dist/kityminder.core.min.js"></script>
    <script>
$(document).ready(function(){
  $('.language-mindmap').each(function(index, element) {
    var markdownText = element.textContent.trim();
    var parentNode = element.parentNode.parentNode;
    var nodeName = '.language-mindmap-' + index;
    var node = document.createElement("div");
    node.className = 'language-mindmap-' + index;
    node.style.height = '' + $(element).height() + 'px';
    parentNode.insertBefore(node, element.parentNode);
    var minder = new kityminder.Minder({
      renderTo: nodeName
    });
    minder.importData('markdown', markdownText);
    /* minder.disable(); */
    minder.execCommand('hand');

    var viewerTipNode = document.createElement("a");
    viewerTipNode.setAttribute('href', '{{ site.url }}/mindmap-viewer/?data=' + encodeURIComponent(markdownText));
    viewerTipNode.setAttribute('target', '_blank');
    viewerTipNode.setAttribute('style', 'font-size:0.8rem;font-style:italic;font-color:grey;');
    viewerTipNode.innerText = '全屏查看';
    parentNode.insertBefore(viewerTipNode, element.parentNode);

    element.parentNode.style.display = 'none';

    {% if page.mindmap-template %}
    setTimeout(function() {
      minder.setTemplate('{{ page.mindmap-template }}');
      minder.refresh();
    }, 100);
    {% endif %}
  });
});
    </script>
    {% endif %}

    {% if site.google.analytics_id %}
    <div style="display:none">
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', '{{ site.google.analytics_id }}', 'auto');
        ga('send', 'pageview');

      </script>
    </div>
    {% endif %}

    <!-- 同时兼容http与https -->
    <script src="https://cdn1.lncld.net/static/js/2.5.0/av-min.js"></script>
    <script>
      console.log('我执行了拉')
      // 第一个参数是appid，第二个参数是appkey，此处的只是示例
      AV.initialize("xedElFQAq91wcPuFzK2bpCTq-gzGzoHsz", "oVDK9Nl1SEhkpI50U67NAsXP");
      // 自己创建的Class的名字
      var name = 'Counter';
      function createRecord(Counter) {
        // 设置 ACL
        var acl = new AV.ACL();
        acl.setPublicReadAccess(true);
        acl.setPublicWriteAccess(true);
        // 获得span的所有元素
        var elements = document.getElementsByClassName('leancloud_visitors');
        // 一次创建多条记录
        var allcounter = [];
        for (var i = 0; i < elements.length; i++) {
          // 若某span的内容不包括 '-' ，则不必创建记录
          if (elements[i].textContent.indexOf('-') == -1) {
            continue;
          }
          var title = elements[i].getAttribute('data-flag-title');
          var url = elements[i].id;
          var newcounter = new Counter();
          newcounter.setACL(acl);
          newcounter.set("title", title);
          newcounter.set("url", url);
          newcounter.set("time", 0);
          allcounter.push(newcounter);
          // 顺便更新显示span为默认值0
          elements[i].textContent = 0;
        }
        AV.Object.saveAll(allcounter).then(function (todo) {
          // 成功保存记录之后
          console.log('创建记录成功！');
        }, function (error) {
          // 异常错误 
          console.error('创建记录失败: ' + error.message);
        });
      }
      function showCount(Counter) {
        // 是否需要创建新纪录的标志（添加一篇新文章）
        var flag = false;
        var query = new AV.Query(name);
        query.greaterThanOrEqualTo('time', 0);
        query.find().then(function (results) {
          // 当获取到的记录为0时置默认值
          if (results.length == 0) {
            $('.leancloud_visitors').text('-');
            flag = true;
            console.log('返回查询记录为空');
            // 如果获取到空记录就创建新记录
            createRecord(Counter);
            return;
          }
          // 将获取到的数据设置为text
          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);
            element.textContent = time;
          }
          // 当某个span含有默认值时说明需要创建记录
          if ($('.leancloud_visitors').text().indexOf("-") != -1) {
            flag = true;
          }
          // 当获取的记录数与span个数不吻合时
          if (results.length != $('.leancloud_visitors').length) {
            flag = true;
          }
          if (flag) {
            createRecord(Counter);
          }
        }, function (error) {
          console.log('query error:' + error.message);
        });
      }
      $(function () {
        var Counter = AV.Object.extend(name);
        showCount(Counter);
      });
    </script>
</body>
</html>
